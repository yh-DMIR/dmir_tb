Args in experiment:
Namespace(activation='gelu', alpha=0.1, attn_dropout=0.15, batch_size=32, ca_layers=1, checkpoints='./checkpoints/', d_ff=128, d_model=128, data='custom', data_path='weather.csv', des='Exp', devices='0,1,2,3', dropout=0.0, embed='timeF', embedding_epochs=5, embedding_lr=0.0005, enc_in=21, features='M', freq='h', gpu=0, ia_layers=1, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', model='TimeBridge', model_id='weather_720_96', n_heads=8, num_p=12, num_workers=10, output_attention=False, patience=3, pct_start=0.2, pd_layers=1, period=48, pred_len=96, revin=True, root_path='./dataset/weather/', seasonal_patterns='Monthly', seq_len=720, stable_len=6, target='OT', train_epochs=10, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_96_TimeBridge_custom_bs32_ftM_sl720_ll48_pl96_dm128_nh8_ial1_pdl1_cal1_df128_ebtimeF_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5785477
	speed: 0.1012s/iter; left time: 1130.9621s
	iters: 200, epoch: 1 | loss: 0.4655640
	speed: 0.0746s/iter; left time: 825.9962s
	iters: 300, epoch: 1 | loss: 0.5140902
	speed: 0.0656s/iter; left time: 719.8794s
	iters: 400, epoch: 1 | loss: 0.5300301
	speed: 0.0599s/iter; left time: 651.4528s
	iters: 500, epoch: 1 | loss: 0.4540254
	speed: 0.0549s/iter; left time: 590.8646s
	iters: 600, epoch: 1 | loss: 0.5323783
	speed: 0.0582s/iter; left time: 620.9270s
	iters: 700, epoch: 1 | loss: 0.5154341
	speed: 0.0568s/iter; left time: 600.0893s
	iters: 800, epoch: 1 | loss: 0.4606951
	speed: 0.0564s/iter; left time: 590.6968s
	iters: 900, epoch: 1 | loss: 0.4542438
	speed: 0.0604s/iter; left time: 626.0556s
	iters: 1000, epoch: 1 | loss: 0.4601916
	speed: 0.0596s/iter; left time: 612.5462s
	iters: 1100, epoch: 1 | loss: 0.4285594
	speed: 0.0650s/iter; left time: 660.8730s
Epoch: 1 cost time: 73.2224006652832
Epoch: 1, Steps: 1127 | Train Loss: 0.5046736 Vali Loss: 0.3896903 Test Loss: 0.1485496
Validation loss decreased (inf --> 0.389690).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4463879
	speed: 1.7731s/iter; left time: 17809.3736s
	iters: 200, epoch: 2 | loss: 0.4476160
	speed: 0.0591s/iter; left time: 587.4006s
	iters: 300, epoch: 2 | loss: 0.4108467
	speed: 0.0637s/iter; left time: 626.6739s
	iters: 400, epoch: 2 | loss: 0.5463676
	speed: 0.0609s/iter; left time: 593.7608s
	iters: 500, epoch: 2 | loss: 0.3878992
	speed: 0.0607s/iter; left time: 585.5055s
	iters: 600, epoch: 2 | loss: 0.4380288
	speed: 0.0639s/iter; left time: 610.0404s
	iters: 700, epoch: 2 | loss: 0.4953764
	speed: 0.0709s/iter; left time: 669.4319s
	iters: 800, epoch: 2 | loss: 0.4640513
	speed: 0.0562s/iter; left time: 525.1613s
	iters: 900, epoch: 2 | loss: 0.4396615
	speed: 0.0583s/iter; left time: 538.5914s
	iters: 1000, epoch: 2 | loss: 0.4510564
	speed: 0.0634s/iter; left time: 579.5744s
	iters: 1100, epoch: 2 | loss: 0.4371349
	speed: 0.0598s/iter; left time: 540.4422s
Epoch: 2 cost time: 70.49513864517212
Epoch: 2, Steps: 1127 | Train Loss: 0.4472119 Vali Loss: 0.3890901 Test Loss: 0.1439524
Validation loss decreased (0.389690 --> 0.389090).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4049735
	speed: 1.8235s/iter; left time: 16260.4388s
	iters: 200, epoch: 3 | loss: 0.4047636
	speed: 0.0655s/iter; left time: 577.9067s
	iters: 300, epoch: 3 | loss: 0.4334887
	speed: 0.0686s/iter; left time: 597.8871s
	iters: 400, epoch: 3 | loss: 0.4317228
	speed: 0.0750s/iter; left time: 646.1296s
	iters: 500, epoch: 3 | loss: 0.4449158
	speed: 0.0728s/iter; left time: 620.4553s
	iters: 600, epoch: 3 | loss: 0.4232321
	speed: 0.0778s/iter; left time: 655.0241s
	iters: 700, epoch: 3 | loss: 0.4640583
	speed: 0.0719s/iter; left time: 597.7646s
	iters: 800, epoch: 3 | loss: 0.4240509
	speed: 0.0591s/iter; left time: 485.3327s
	iters: 900, epoch: 3 | loss: 0.4104668
	speed: 0.0617s/iter; left time: 500.8728s
	iters: 1000, epoch: 3 | loss: 0.4586011
	speed: 0.0622s/iter; left time: 498.6946s
	iters: 1100, epoch: 3 | loss: 0.3960713
	speed: 0.0678s/iter; left time: 536.5427s
Epoch: 3 cost time: 77.64680480957031
Epoch: 3, Steps: 1127 | Train Loss: 0.4369168 Vali Loss: 0.3857826 Test Loss: 0.1423137
Validation loss decreased (0.389090 --> 0.385783).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4578356
	speed: 1.7299s/iter; left time: 13475.5999s
	iters: 200, epoch: 4 | loss: 0.4428455
	speed: 0.0625s/iter; left time: 480.6824s
	iters: 300, epoch: 4 | loss: 0.4467816
	speed: 0.0522s/iter; left time: 395.8617s
	iters: 400, epoch: 4 | loss: 0.4790246
	speed: 0.0537s/iter; left time: 402.3534s
	iters: 500, epoch: 4 | loss: 0.4604687
	speed: 0.0551s/iter; left time: 407.5280s
	iters: 600, epoch: 4 | loss: 0.4307711
	speed: 0.0495s/iter; left time: 360.5591s
	iters: 700, epoch: 4 | loss: 0.3880081
	speed: 0.0519s/iter; left time: 372.8152s
	iters: 800, epoch: 4 | loss: 0.4689423
	speed: 0.0519s/iter; left time: 367.7478s
	iters: 900, epoch: 4 | loss: 0.3989431
	speed: 0.0497s/iter; left time: 347.6651s
	iters: 1000, epoch: 4 | loss: 0.4719089
	speed: 0.0533s/iter; left time: 366.9430s
	iters: 1100, epoch: 4 | loss: 0.3994493
	speed: 0.0534s/iter; left time: 362.7375s
Epoch: 4 cost time: 61.91602325439453
Epoch: 4, Steps: 1127 | Train Loss: 0.4326533 Vali Loss: 0.3830063 Test Loss: 0.1418354
Validation loss decreased (0.385783 --> 0.383006).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4661602
	speed: 1.4270s/iter; left time: 9508.0120s
	iters: 200, epoch: 5 | loss: 0.4082273
	speed: 0.0645s/iter; left time: 423.1094s
	iters: 300, epoch: 5 | loss: 0.3877291
	speed: 0.0671s/iter; left time: 433.4085s
	iters: 400, epoch: 5 | loss: 0.4626859
	speed: 0.0638s/iter; left time: 405.7401s
	iters: 500, epoch: 5 | loss: 0.4028142
	speed: 0.0746s/iter; left time: 467.4499s
	iters: 600, epoch: 5 | loss: 0.3978270
	speed: 0.0717s/iter; left time: 441.5861s
	iters: 700, epoch: 5 | loss: 0.5045117
	speed: 0.0540s/iter; left time: 327.1040s
	iters: 800, epoch: 5 | loss: 0.4202686
	speed: 0.0517s/iter; left time: 308.3161s
	iters: 900, epoch: 5 | loss: 0.3779134
	speed: 0.0609s/iter; left time: 356.8824s
	iters: 1000, epoch: 5 | loss: 0.4290966
	speed: 0.0501s/iter; left time: 288.9791s
	iters: 1100, epoch: 5 | loss: 0.4171030
	speed: 0.0440s/iter; left time: 249.0438s
Epoch: 5 cost time: 68.83594989776611
Epoch: 5, Steps: 1127 | Train Loss: 0.4304342 Vali Loss: 0.3846913 Test Loss: 0.1416171
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.3767231
	speed: 1.4130s/iter; left time: 7822.3518s
	iters: 200, epoch: 6 | loss: 0.4540642
	speed: 0.0455s/iter; left time: 247.2858s
	iters: 300, epoch: 6 | loss: 0.4354897
	speed: 0.0447s/iter; left time: 238.2845s
	iters: 400, epoch: 6 | loss: 0.4385502
	speed: 0.0461s/iter; left time: 241.5693s
	iters: 500, epoch: 6 | loss: 0.4345920
	speed: 0.0453s/iter; left time: 232.8223s
	iters: 600, epoch: 6 | loss: 0.4519070
	speed: 0.0499s/iter; left time: 251.3799s
	iters: 700, epoch: 6 | loss: 0.4451503
	speed: 0.0570s/iter; left time: 281.1563s
	iters: 800, epoch: 6 | loss: 0.4131763
	speed: 0.0492s/iter; left time: 238.0637s
	iters: 900, epoch: 6 | loss: 0.4296282
	speed: 0.0457s/iter; left time: 216.3673s
	iters: 1000, epoch: 6 | loss: 0.4032271
	speed: 0.0515s/iter; left time: 238.9393s
	iters: 1100, epoch: 6 | loss: 0.4193231
	speed: 0.0546s/iter; left time: 247.6104s
Epoch: 6 cost time: 55.326622009277344
Epoch: 6, Steps: 1127 | Train Loss: 0.4292904 Vali Loss: 0.3841518 Test Loss: 0.1414385
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 7 | loss: 0.4147420
	speed: 1.2384s/iter; left time: 5460.1982s
	iters: 200, epoch: 7 | loss: 0.4032763
	speed: 0.0609s/iter; left time: 262.3250s
	iters: 300, epoch: 7 | loss: 0.4880708
	speed: 0.0618s/iter; left time: 260.1471s
	iters: 400, epoch: 7 | loss: 0.4918026
	speed: 0.0598s/iter; left time: 245.6057s
	iters: 500, epoch: 7 | loss: 0.3862007
	speed: 0.0407s/iter; left time: 163.2353s
	iters: 600, epoch: 7 | loss: 0.4152926
	speed: 0.0410s/iter; left time: 160.1461s
	iters: 700, epoch: 7 | loss: 0.4504980
	speed: 0.0411s/iter; left time: 156.3770s
	iters: 800, epoch: 7 | loss: 0.3932928
	speed: 0.0407s/iter; left time: 151.0383s
	iters: 900, epoch: 7 | loss: 0.3851716
	speed: 0.0407s/iter; left time: 147.0651s
	iters: 1000, epoch: 7 | loss: 0.4317025
	speed: 0.0439s/iter; left time: 153.9152s
	iters: 1100, epoch: 7 | loss: 0.4186457
	speed: 0.0489s/iter; left time: 166.5322s
Epoch: 7 cost time: 55.59353828430176
Epoch: 7, Steps: 1127 | Train Loss: 0.4286977 Vali Loss: 0.3825914 Test Loss: 0.1413113
Validation loss decreased (0.383006 --> 0.382591).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3881662
	speed: 1.2879s/iter; left time: 4226.9865s
	iters: 200, epoch: 8 | loss: 0.4059704
	speed: 0.0467s/iter; left time: 148.4517s
	iters: 300, epoch: 8 | loss: 0.4227554
	speed: 0.0409s/iter; left time: 126.0616s
	iters: 400, epoch: 8 | loss: 0.4426411
	speed: 0.0411s/iter; left time: 122.7021s
	iters: 500, epoch: 8 | loss: 0.4144063
	speed: 0.0410s/iter; left time: 118.0794s
	iters: 600, epoch: 8 | loss: 0.4415275
	speed: 0.0408s/iter; left time: 113.5783s
	iters: 700, epoch: 8 | loss: 0.3374670
	speed: 0.0410s/iter; left time: 110.0690s
	iters: 800, epoch: 8 | loss: 0.4749999
	speed: 0.0411s/iter; left time: 106.1521s
	iters: 900, epoch: 8 | loss: 0.4051970
	speed: 0.0411s/iter; left time: 102.0470s
	iters: 1000, epoch: 8 | loss: 0.4210769
	speed: 0.0411s/iter; left time: 97.7851s
	iters: 1100, epoch: 8 | loss: 0.4310571
	speed: 0.0412s/iter; left time: 93.9233s
Epoch: 8 cost time: 49.26278066635132
Epoch: 8, Steps: 1127 | Train Loss: 0.4284428 Vali Loss: 0.3824295 Test Loss: 0.1412982
Validation loss decreased (0.382591 --> 0.382430).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3973711
	speed: 1.2746s/iter; left time: 2746.6877s
	iters: 200, epoch: 9 | loss: 0.3447976
	speed: 0.0616s/iter; left time: 126.4855s
	iters: 300, epoch: 9 | loss: 0.4596660
	speed: 0.0591s/iter; left time: 115.4756s
	iters: 400, epoch: 9 | loss: 0.4204697
	speed: 0.0605s/iter; left time: 112.1401s
	iters: 500, epoch: 9 | loss: 0.4099256
	speed: 0.0480s/iter; left time: 84.2805s
	iters: 600, epoch: 9 | loss: 0.3907451
	speed: 0.0477s/iter; left time: 78.9734s
	iters: 700, epoch: 9 | loss: 0.3727833
	speed: 0.0471s/iter; left time: 73.2755s
	iters: 800, epoch: 9 | loss: 0.3942220
	speed: 0.0532s/iter; left time: 77.4011s
	iters: 900, epoch: 9 | loss: 0.3978198
	speed: 0.0542s/iter; left time: 73.4364s
	iters: 1000, epoch: 9 | loss: 0.3987975
	speed: 0.0443s/iter; left time: 55.6444s
	iters: 1100, epoch: 9 | loss: 0.4610441
	speed: 0.0442s/iter; left time: 51.0937s
Epoch: 9 cost time: 60.03983950614929
Epoch: 9, Steps: 1127 | Train Loss: 0.4282356 Vali Loss: 0.3826933 Test Loss: 0.1413510
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 10 | loss: 0.4464185
	speed: 1.2345s/iter; left time: 1269.0536s
	iters: 200, epoch: 10 | loss: 0.4347816
	speed: 0.0407s/iter; left time: 37.8153s
	iters: 300, epoch: 10 | loss: 0.4152308
	speed: 0.0407s/iter; left time: 33.7179s
	iters: 400, epoch: 10 | loss: 0.4445526
	speed: 0.0408s/iter; left time: 29.7161s
	iters: 500, epoch: 10 | loss: 0.3932676
	speed: 0.0408s/iter; left time: 25.6142s
	iters: 600, epoch: 10 | loss: 0.4492808
	speed: 0.0407s/iter; left time: 21.5158s
	iters: 700, epoch: 10 | loss: 0.5230707
	speed: 0.0407s/iter; left time: 17.4243s
	iters: 800, epoch: 10 | loss: 0.3659698
	speed: 0.0411s/iter; left time: 13.4725s
	iters: 900, epoch: 10 | loss: 0.3813049
	speed: 0.0435s/iter; left time: 9.9078s
	iters: 1000, epoch: 10 | loss: 0.4985368
	speed: 0.0435s/iter; left time: 5.5712s
	iters: 1100, epoch: 10 | loss: 0.4073831
	speed: 0.0448s/iter; left time: 1.2550s
Epoch: 10 cost time: 47.90360236167908
Epoch: 10, Steps: 1127 | Train Loss: 0.4281511 Vali Loss: 0.3814859 Test Loss: 0.1413487
Validation loss decreased (0.382430 --> 0.381486).  Saving model ...
>>>>>>>testing : weather_720_96_TimeBridge_custom_bs32_ftM_sl720_ll48_pl96_dm128_nh8_ial1_pdl1_cal1_df128_ebtimeF_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.14134907722473145, mae:0.1819356083869934
rmse:0.3759641945362091, mape:0.4407278299331665, mspe:9395207.0
