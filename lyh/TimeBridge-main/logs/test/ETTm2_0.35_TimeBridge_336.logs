Args in experiment:
Namespace(activation='gelu', alpha=0.35, attn_dropout=0.15, batch_size=64, ca_layers=0, checkpoints='./checkpoints/', d_ff=128, d_model=64, data='ETTm2', data_path='ETTm2.csv', des='Exp', devices='0,1,2,3', dropout=0.0, embed='timeF', embedding_epochs=5, embedding_lr=0.0005, enc_in=7, features='M', freq='h', gpu=0, ia_layers=3, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0002, loss='MSE', lradj='TST', model='TimeBridge', model_id='ETTm2_720_336', n_heads=4, num_p=None, num_workers=10, output_attention=False, patience=10, pct_start=0.2, pd_layers=1, period=48, pred_len=336, revin=True, root_path='./dataset/ETT-small/', seasonal_patterns='Monthly', seq_len=720, stable_len=6, target='OT', train_epochs=100, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_336_TimeBridge_ETTm2_bs64_ftM_sl720_ll48_pl336_dm64_nh4_ial3_pdl1_cal0_df128_ebtimeF_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 3.3233199
	speed: 0.0952s/iter; left time: 4970.5498s
	iters: 200, epoch: 1 | loss: 3.0545635
	speed: 0.0819s/iter; left time: 4265.4603s
	iters: 300, epoch: 1 | loss: 2.1446428
	speed: 0.0638s/iter; left time: 3318.3072s
	iters: 400, epoch: 1 | loss: 2.2851198
	speed: 0.0536s/iter; left time: 2782.3792s
	iters: 500, epoch: 1 | loss: 2.0500152
	speed: 0.0535s/iter; left time: 2773.1594s
Epoch: 1 cost time: 35.81087279319763
Epoch: 1, Steps: 523 | Train Loss: 2.8061142 Vali Loss: 0.2738463 Test Loss: 0.3673941
Validation loss decreased (inf --> 0.273846).  Saving model ...
Updating learning rate to 9.182144858656152e-06
	iters: 100, epoch: 2 | loss: 1.7793683
	speed: 1.5529s/iter; left time: 80252.6413s
	iters: 200, epoch: 2 | loss: 1.7639780
	speed: 0.0509s/iter; left time: 2624.8492s
	iters: 300, epoch: 2 | loss: 1.7379805
	speed: 0.0516s/iter; left time: 2654.2757s
	iters: 400, epoch: 2 | loss: 1.6792443
	speed: 0.0536s/iter; left time: 2754.9458s
	iters: 500, epoch: 2 | loss: 1.6903564
	speed: 0.0521s/iter; left time: 2671.4386s
Epoch: 2 cost time: 28.544812440872192
Epoch: 2, Steps: 523 | Train Loss: 1.7390053 Vali Loss: 0.2543101 Test Loss: 0.3429375
Validation loss decreased (0.273846 --> 0.254310).  Saving model ...
Updating learning rate to 1.2699465549898567e-05
	iters: 100, epoch: 3 | loss: 1.6748279
	speed: 1.6840s/iter; left time: 86145.5546s
	iters: 200, epoch: 3 | loss: 1.5436497
	speed: 0.0876s/iter; left time: 4470.5277s
	iters: 300, epoch: 3 | loss: 1.4782642
	speed: 0.0882s/iter; left time: 4493.8196s
	iters: 400, epoch: 3 | loss: 1.5137234
	speed: 0.0665s/iter; left time: 3379.3435s
	iters: 500, epoch: 3 | loss: 1.5374435
	speed: 0.0641s/iter; left time: 3252.2962s
Epoch: 3 cost time: 41.16834998130798
Epoch: 3, Steps: 523 | Train Loss: 1.5979432 Vali Loss: 0.2354380 Test Loss: 0.3202248
Validation loss decreased (0.254310 --> 0.235438).  Saving model ...
Updating learning rate to 1.8465337436823174e-05
	iters: 100, epoch: 4 | loss: 1.5407799
	speed: 1.6383s/iter; left time: 82949.0473s
	iters: 200, epoch: 4 | loss: 1.3548179
	speed: 0.0510s/iter; left time: 2577.3611s
	iters: 300, epoch: 4 | loss: 1.4544046
	speed: 0.0514s/iter; left time: 2590.3292s
	iters: 400, epoch: 4 | loss: 1.6089176
	speed: 0.0558s/iter; left time: 2808.6084s
	iters: 500, epoch: 4 | loss: 1.5120184
	speed: 0.0526s/iter; left time: 2644.4874s
Epoch: 4 cost time: 28.038835287094116
Epoch: 4, Steps: 523 | Train Loss: 1.5373304 Vali Loss: 0.2232437 Test Loss: 0.3027921
Validation loss decreased (0.235438 --> 0.223244).  Saving model ...
Updating learning rate to 2.6337758523455013e-05
	iters: 100, epoch: 5 | loss: 1.4713373
	speed: 1.6419s/iter; left time: 82272.9352s
	iters: 200, epoch: 5 | loss: 1.5002973
	speed: 0.0682s/iter; left time: 3412.4412s
	iters: 300, epoch: 5 | loss: 1.5991390
	speed: 0.0739s/iter; left time: 3687.3351s
	iters: 400, epoch: 5 | loss: 1.5096637
	speed: 0.0506s/iter; left time: 2519.6474s
	iters: 500, epoch: 5 | loss: 1.3753281
	speed: 0.0490s/iter; left time: 2435.4387s
Epoch: 5 cost time: 32.717267751693726
Epoch: 5, Steps: 523 | Train Loss: 1.5013626 Vali Loss: 0.2182422 Test Loss: 0.2928616
Validation loss decreased (0.223244 --> 0.218242).  Saving model ...
Updating learning rate to 3.612284668244535e-05
	iters: 100, epoch: 6 | loss: 1.4502478
	speed: 1.5714s/iter; left time: 77918.8090s
	iters: 200, epoch: 6 | loss: 1.3373325
	speed: 0.0480s/iter; left time: 2375.6136s
	iters: 300, epoch: 6 | loss: 1.5511727
	speed: 0.0497s/iter; left time: 2453.8320s
	iters: 400, epoch: 6 | loss: 1.3971349
	speed: 0.0453s/iter; left time: 2234.8680s
	iters: 500, epoch: 6 | loss: 1.6260469
	speed: 0.0497s/iter; left time: 2443.0737s
Epoch: 6 cost time: 26.0535991191864
Epoch: 6, Steps: 523 | Train Loss: 1.4774151 Vali Loss: 0.2118284 Test Loss: 0.2846917
Validation loss decreased (0.218242 --> 0.211828).  Saving model ...
Updating learning rate to 4.757961458757239e-05
	iters: 100, epoch: 7 | loss: 1.5987599
	speed: 1.6442s/iter; left time: 80670.4274s
	iters: 200, epoch: 7 | loss: 1.4934808
	speed: 0.0751s/iter; left time: 3679.4078s
	iters: 300, epoch: 7 | loss: 1.3750914
	speed: 0.0472s/iter; left time: 2307.9236s
	iters: 400, epoch: 7 | loss: 1.4178704
	speed: 0.0456s/iter; left time: 2225.1836s
	iters: 500, epoch: 7 | loss: 1.5012145
	speed: 0.0472s/iter; left time: 2296.3560s
Epoch: 7 cost time: 31.25471067428589
Epoch: 7, Steps: 523 | Train Loss: 1.4579548 Vali Loss: 0.2072684 Test Loss: 0.2774245
Validation loss decreased (0.211828 --> 0.207268).  Saving model ...
Updating learning rate to 6.0425904753922327e-05
	iters: 100, epoch: 8 | loss: 1.4787834
	speed: 1.5756s/iter; left time: 76479.3761s
	iters: 200, epoch: 8 | loss: 1.3688787
	speed: 0.0669s/iter; left time: 3242.8247s
	iters: 300, epoch: 8 | loss: 1.5750210
	speed: 0.0606s/iter; left time: 2927.4984s
	iters: 400, epoch: 8 | loss: 1.5055509
	speed: 0.0535s/iter; left time: 2582.5357s
	iters: 500, epoch: 8 | loss: 1.3000809
	speed: 0.0542s/iter; left time: 2609.3327s
Epoch: 8 cost time: 33.452088832855225
Epoch: 8, Steps: 523 | Train Loss: 1.4399283 Vali Loss: 0.2037485 Test Loss: 0.2740259
Validation loss decreased (0.207268 --> 0.203748).  Saving model ...
Updating learning rate to 7.434533851747528e-05
	iters: 100, epoch: 9 | loss: 1.5127311
	speed: 1.7121s/iter; left time: 82208.0100s
	iters: 200, epoch: 9 | loss: 1.3729565
	speed: 0.0523s/iter; left time: 2505.1272s
	iters: 300, epoch: 9 | loss: 1.5015607
	speed: 0.0514s/iter; left time: 2460.1327s
	iters: 400, epoch: 9 | loss: 1.3873526
	speed: 0.0496s/iter; left time: 2365.2634s
	iters: 500, epoch: 9 | loss: 1.3517232
	speed: 0.0556s/iter; left time: 2649.0032s
Epoch: 9 cost time: 29.79900860786438
Epoch: 9, Steps: 523 | Train Loss: 1.4251323 Vali Loss: 0.1981367 Test Loss: 0.2709964
Validation loss decreased (0.203748 --> 0.198137).  Saving model ...
Updating learning rate to 8.899510781450224e-05
	iters: 100, epoch: 10 | loss: 1.3673223
	speed: 1.6405s/iter; left time: 77912.2774s
	iters: 200, epoch: 10 | loss: 1.3356450
	speed: 0.0495s/iter; left time: 2345.2724s
	iters: 300, epoch: 10 | loss: 1.2847229
	speed: 0.0518s/iter; left time: 2451.8575s
	iters: 400, epoch: 10 | loss: 1.3422235
	speed: 0.0579s/iter; left time: 2734.5154s
	iters: 500, epoch: 10 | loss: 1.6361363
	speed: 0.0470s/iter; left time: 2213.2668s
Epoch: 10 cost time: 27.461710691452026
Epoch: 10, Steps: 523 | Train Loss: 1.4146036 Vali Loss: 0.1951241 Test Loss: 0.2698102
Validation loss decreased (0.198137 --> 0.195124).  Saving model ...
Updating learning rate to 0.00010401441786469121
	iters: 100, epoch: 11 | loss: 1.5679451
	speed: 1.5854s/iter; left time: 74466.6840s
	iters: 200, epoch: 11 | loss: 1.5613946
	speed: 0.0509s/iter; left time: 2385.2035s
	iters: 300, epoch: 11 | loss: 1.3968424
	speed: 0.0513s/iter; left time: 2401.5628s
	iters: 400, epoch: 11 | loss: 1.4661801
	speed: 0.0512s/iter; left time: 2388.2030s
	iters: 500, epoch: 11 | loss: 1.4486454
	speed: 0.0575s/iter; left time: 2678.1790s
Epoch: 11 cost time: 28.14119243621826
Epoch: 11, Steps: 523 | Train Loss: 1.4066271 Vali Loss: 0.1954603 Test Loss: 0.2688740
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00011903337283145066
	iters: 100, epoch: 12 | loss: 1.4783769
	speed: 1.5784s/iter; left time: 73311.8968s
	iters: 200, epoch: 12 | loss: 1.3664507
	speed: 0.0630s/iter; left time: 2921.9192s
	iters: 300, epoch: 12 | loss: 1.2823089
	speed: 0.0637s/iter; left time: 2947.3846s
	iters: 400, epoch: 12 | loss: 1.4848421
	speed: 0.0619s/iter; left time: 2856.0686s
	iters: 500, epoch: 12 | loss: 1.3121014
	speed: 0.0562s/iter; left time: 2586.8793s
Epoch: 12 cost time: 32.32684850692749
Epoch: 12, Steps: 523 | Train Loss: 1.4010794 Vali Loss: 0.1934627 Test Loss: 0.2683706
Validation loss decreased (0.195124 --> 0.193463).  Saving model ...
Updating learning rate to 0.0001336820856231901
	iters: 100, epoch: 13 | loss: 1.3421063
	speed: 1.5958s/iter; left time: 73288.4305s
	iters: 200, epoch: 13 | loss: 1.2922958
	speed: 0.0587s/iter; left time: 2690.7242s
	iters: 300, epoch: 13 | loss: 1.4351023
	speed: 0.0779s/iter; left time: 3560.4204s
	iters: 400, epoch: 13 | loss: 1.4205289
	speed: 0.0647s/iter; left time: 2951.6893s
	iters: 500, epoch: 13 | loss: 1.3344399
	speed: 0.0507s/iter; left time: 2308.8004s
Epoch: 13 cost time: 33.102487564086914
Epoch: 13, Steps: 523 | Train Loss: 1.3960129 Vali Loss: 0.1919603 Test Loss: 0.2695676
Validation loss decreased (0.193463 --> 0.191960).  Saving model ...
Updating learning rate to 0.00014759978747922863
	iters: 100, epoch: 14 | loss: 1.3991066
	speed: 1.3828s/iter; left time: 62783.3651s
	iters: 200, epoch: 14 | loss: 1.3063116
	speed: 0.0459s/iter; left time: 2081.1909s
	iters: 300, epoch: 14 | loss: 1.2761375
	speed: 0.0505s/iter; left time: 2282.4496s
	iters: 400, epoch: 14 | loss: 1.4157917
	speed: 0.0364s/iter; left time: 1642.0537s
	iters: 500, epoch: 14 | loss: 1.3502486
	speed: 0.0360s/iter; left time: 1618.1292s
Epoch: 14 cost time: 22.307389497756958
Epoch: 14, Steps: 523 | Train Loss: 1.3902363 Vali Loss: 0.1894829 Test Loss: 0.2716304
Validation loss decreased (0.191960 --> 0.189483).  Saving model ...
Updating learning rate to 0.00016044371298928648
	iters: 100, epoch: 15 | loss: 1.2702157
	speed: 1.2844s/iter; left time: 57641.4291s
	iters: 200, epoch: 15 | loss: 1.2796804
	speed: 0.0344s/iter; left time: 1538.6147s
	iters: 300, epoch: 15 | loss: 1.3359240
	speed: 0.0350s/iter; left time: 1565.7145s
	iters: 400, epoch: 15 | loss: 1.4091483
	speed: 0.0346s/iter; left time: 1544.6080s
	iters: 500, epoch: 15 | loss: 1.2492521
	speed: 0.0338s/iter; left time: 1505.2364s
Epoch: 15 cost time: 18.701947450637817
Epoch: 15, Steps: 523 | Train Loss: 1.3831765 Vali Loss: 0.2038755 Test Loss: 0.2708214
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00017189754172614128
	iters: 100, epoch: 16 | loss: 1.4179447
	speed: 1.2575s/iter; left time: 55775.8726s
	iters: 200, epoch: 16 | loss: 1.3687012
	speed: 0.0487s/iter; left time: 2155.6941s
	iters: 300, epoch: 16 | loss: 1.3205067
	speed: 0.0468s/iter; left time: 2065.1997s
	iters: 400, epoch: 16 | loss: 1.2871157
	speed: 0.0381s/iter; left time: 1678.7358s
	iters: 500, epoch: 16 | loss: 1.3738796
	speed: 0.0378s/iter; left time: 1661.3328s
Epoch: 16 cost time: 23.778059720993042
Epoch: 16, Steps: 523 | Train Loss: 1.3758533 Vali Loss: 0.2000000 Test Loss: 0.2739996
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000181679188590768
	iters: 100, epoch: 17 | loss: 1.2787782
	speed: 1.2907s/iter; left time: 56575.0032s
	iters: 200, epoch: 17 | loss: 1.3811527
	speed: 0.0353s/iter; left time: 1545.6473s
	iters: 300, epoch: 17 | loss: 1.4647441
	speed: 0.0370s/iter; left time: 1616.5784s
	iters: 400, epoch: 17 | loss: 1.4485496
	speed: 0.0395s/iter; left time: 1718.7225s
	iters: 500, epoch: 17 | loss: 1.3423750
	speed: 0.0397s/iter; left time: 1724.3452s
Epoch: 17 cost time: 20.34090256690979
Epoch: 17, Steps: 523 | Train Loss: 1.3689011 Vali Loss: 0.2006671 Test Loss: 0.2839853
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.00018954775100920394
	iters: 100, epoch: 18 | loss: 1.5156934
	speed: 1.2158s/iter; left time: 52656.7553s
	iters: 200, epoch: 18 | loss: 1.2928007
	speed: 0.0371s/iter; left time: 1604.2843s
	iters: 300, epoch: 18 | loss: 1.3100988
	speed: 0.0392s/iter; left time: 1690.5556s
	iters: 400, epoch: 18 | loss: 1.3840517
	speed: 0.0622s/iter; left time: 2674.5306s
	iters: 500, epoch: 18 | loss: 1.2749566
	speed: 0.0363s/iter; left time: 1555.6391s
Epoch: 18 cost time: 22.61656928062439
Epoch: 18, Steps: 523 | Train Loss: 1.3635104 Vali Loss: 0.2006443 Test Loss: 0.2792805
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.00019530944188544976
	iters: 100, epoch: 19 | loss: 1.4942098
	speed: 1.2324s/iter; left time: 52730.8560s
	iters: 200, epoch: 19 | loss: 1.3118775
	speed: 0.0554s/iter; left time: 2364.6947s
	iters: 300, epoch: 19 | loss: 1.3604851
	speed: 0.0487s/iter; left time: 2072.1187s
	iters: 400, epoch: 19 | loss: 1.3494687
	speed: 0.0491s/iter; left time: 2083.9878s
	iters: 500, epoch: 19 | loss: 1.2863154
	speed: 0.0393s/iter; left time: 1665.6071s
Epoch: 19 cost time: 25.235368251800537
Epoch: 19, Steps: 523 | Train Loss: 1.3569305 Vali Loss: 0.2073661 Test Loss: 0.2761925
EarlyStopping counter: 5 out of 10
Updating learning rate to 0.00019882236219353631
	iters: 100, epoch: 20 | loss: 1.3622079
	speed: 1.2912s/iter; left time: 54570.6157s
	iters: 200, epoch: 20 | loss: 1.3528806
	speed: 0.0388s/iter; left time: 1634.6726s
	iters: 300, epoch: 20 | loss: 1.3324002
	speed: 0.0400s/iter; left time: 1681.6106s
	iters: 400, epoch: 20 | loss: 1.3595660
	speed: 0.0391s/iter; left time: 1642.2490s
	iters: 500, epoch: 20 | loss: 1.4449251
	speed: 0.0451s/iter; left time: 1888.2922s
Epoch: 20 cost time: 22.036876678466797
Epoch: 20, Steps: 523 | Train Loss: 1.3515257 Vali Loss: 0.2080790 Test Loss: 0.2802719
EarlyStopping counter: 6 out of 10
Updating learning rate to 0.00019999999971810677
	iters: 100, epoch: 21 | loss: 1.4830811
	speed: 1.3178s/iter; left time: 55006.3257s
	iters: 200, epoch: 21 | loss: 1.2972004
	speed: 0.0392s/iter; left time: 1630.3073s
	iters: 300, epoch: 21 | loss: 1.3101021
	speed: 0.0406s/iter; left time: 1687.1170s
	iters: 400, epoch: 21 | loss: 1.4453441
	speed: 0.0403s/iter; left time: 1671.0696s
	iters: 500, epoch: 21 | loss: 1.4172451
	speed: 0.0402s/iter; left time: 1662.2365s
Epoch: 21 cost time: 21.66949462890625
Epoch: 21, Steps: 523 | Train Loss: 1.3451139 Vali Loss: 0.2133572 Test Loss: 0.2856594
EarlyStopping counter: 7 out of 10
Updating learning rate to 0.0001999226088662329
	iters: 100, epoch: 22 | loss: 1.3159199
	speed: 1.2283s/iter; left time: 50627.3810s
	iters: 200, epoch: 22 | loss: 1.3811074
	speed: 0.0380s/iter; left time: 1562.7950s
	iters: 300, epoch: 22 | loss: 1.4360429
	speed: 0.0432s/iter; left time: 1771.8000s
	iters: 400, epoch: 22 | loss: 1.2639726
	speed: 0.0509s/iter; left time: 2084.1052s
	iters: 500, epoch: 22 | loss: 1.2985817
	speed: 0.0472s/iter; left time: 1926.3202s
Epoch: 22 cost time: 23.80863618850708
Epoch: 22, Steps: 523 | Train Loss: 1.3373179 Vali Loss: 0.2112231 Test Loss: 0.2787400
EarlyStopping counter: 8 out of 10
Updating learning rate to 0.00019969114521079347
	iters: 100, epoch: 23 | loss: 1.3068488
	speed: 1.2653s/iter; left time: 51493.3564s
	iters: 200, epoch: 23 | loss: 1.2950596
	speed: 0.0374s/iter; left time: 1519.0956s
	iters: 300, epoch: 23 | loss: 1.3363138
	speed: 0.0425s/iter; left time: 1721.3006s
	iters: 400, epoch: 23 | loss: 1.2494385
	speed: 0.0404s/iter; left time: 1631.2640s
	iters: 500, epoch: 23 | loss: 1.3073124
	speed: 0.0419s/iter; left time: 1687.0322s
Epoch: 23 cost time: 21.793335437774658
Epoch: 23, Steps: 523 | Train Loss: 1.3299813 Vali Loss: 0.2139633 Test Loss: 0.2866905
EarlyStopping counter: 9 out of 10
Updating learning rate to 0.00019930596565196837
	iters: 100, epoch: 24 | loss: 1.2573766
	speed: 1.2599s/iter; left time: 50613.9034s
	iters: 200, epoch: 24 | loss: 1.2806118
	speed: 0.0375s/iter; left time: 1503.3720s
	iters: 300, epoch: 24 | loss: 1.3127604
	speed: 0.0352s/iter; left time: 1408.8634s
	iters: 400, epoch: 24 | loss: 1.2711158
	speed: 0.0363s/iter; left time: 1448.4005s
	iters: 500, epoch: 24 | loss: 1.2902615
	speed: 0.0364s/iter; left time: 1446.6808s
Epoch: 24 cost time: 19.596370458602905
Epoch: 24, Steps: 523 | Train Loss: 1.3225109 Vali Loss: 0.2200485 Test Loss: 0.2890075
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : ETTm2_720_336_TimeBridge_ETTm2_bs64_ftM_sl720_ll48_pl336_dm64_nh4_ial3_pdl1_cal0_df128_ebtimeF_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 1, 336, 7) (11185, 1, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.27163031697273254, mae:0.32242411375045776
rmse:0.5211816430091858, mape:0.4689643383026123, mspe:203.02642822265625
