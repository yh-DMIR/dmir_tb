Args in experiment:
Namespace(activation='gelu', alpha=0.1, attn_dropout=0.15, batch_size=32, ca_layers=1, checkpoints='./checkpoints/', d_ff=128, d_model=128, data='custom', data_path='weather.csv', des='Exp', devices='0,1,2,3', dropout=0.0, embed='timeF', embedding_epochs=5, embedding_lr=0.0005, enc_in=21, features='M', freq='h', gpu=0, ia_layers=1, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', model='TimeBridge', model_id='weather_720_336', n_heads=8, num_p=12, num_workers=10, output_attention=False, patience=3, pct_start=0.2, pd_layers=1, period=48, pred_len=336, revin=True, root_path='./dataset/weather/', seasonal_patterns='Monthly', seq_len=720, stable_len=6, target='OT', train_epochs=10, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_336_TimeBridge_custom_bs32_ftM_sl720_ll48_pl336_dm128_nh8_ial1_pdl1_cal1_df128_ebtimeF_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.7923764
	speed: 0.1089s/iter; left time: 1207.9493s
	iters: 200, epoch: 1 | loss: 0.8037002
	speed: 0.0745s/iter; left time: 818.7222s
	iters: 300, epoch: 1 | loss: 0.9164824
	speed: 0.0613s/iter; left time: 667.9382s
	iters: 400, epoch: 1 | loss: 0.7091035
	speed: 0.0492s/iter; left time: 530.7264s
	iters: 500, epoch: 1 | loss: 0.7187349
	speed: 0.0543s/iter; left time: 580.8886s
	iters: 600, epoch: 1 | loss: 0.7953845
	speed: 0.0711s/iter; left time: 752.5360s
	iters: 700, epoch: 1 | loss: 0.7409232
	speed: 0.0635s/iter; left time: 666.1692s
	iters: 800, epoch: 1 | loss: 0.7154454
	speed: 0.0606s/iter; left time: 629.1753s
	iters: 900, epoch: 1 | loss: 0.7439740
	speed: 0.0717s/iter; left time: 737.4441s
	iters: 1000, epoch: 1 | loss: 0.8120451
	speed: 0.0616s/iter; left time: 627.6765s
	iters: 1100, epoch: 1 | loss: 0.6894751
	speed: 0.0520s/iter; left time: 525.2326s
Epoch: 1 cost time: 73.86124110221863
Epoch: 1, Steps: 1119 | Train Loss: 0.7889278 Vali Loss: 0.5177957 Test Loss: 0.2460406
Validation loss decreased (inf --> 0.517796).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7238955
	speed: 1.4052s/iter; left time: 14012.6077s
	iters: 200, epoch: 2 | loss: 0.7210218
	speed: 0.0565s/iter; left time: 557.6826s
	iters: 300, epoch: 2 | loss: 0.7602916
	speed: 0.0535s/iter; left time: 522.7806s
	iters: 400, epoch: 2 | loss: 0.7316335
	speed: 0.0522s/iter; left time: 504.8277s
	iters: 500, epoch: 2 | loss: 0.8045304
	speed: 0.0539s/iter; left time: 516.1963s
	iters: 600, epoch: 2 | loss: 0.7071850
	speed: 0.0517s/iter; left time: 489.7710s
	iters: 700, epoch: 2 | loss: 0.6885179
	speed: 0.0590s/iter; left time: 553.1527s
	iters: 800, epoch: 2 | loss: 0.7544481
	speed: 0.0660s/iter; left time: 612.0135s
	iters: 900, epoch: 2 | loss: 0.7227232
	speed: 0.0643s/iter; left time: 589.7315s
	iters: 1000, epoch: 2 | loss: 0.6307504
	speed: 0.0770s/iter; left time: 698.1917s
	iters: 1100, epoch: 2 | loss: 0.7571300
	speed: 0.0776s/iter; left time: 695.8693s
Epoch: 2 cost time: 69.97566270828247
Epoch: 2, Steps: 1119 | Train Loss: 0.7280683 Vali Loss: 0.5089118 Test Loss: 0.2407430
Validation loss decreased (0.517796 --> 0.508912).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7121712
	speed: 1.4880s/iter; left time: 13173.5019s
	iters: 200, epoch: 3 | loss: 0.8340594
	speed: 0.0916s/iter; left time: 802.1184s
	iters: 300, epoch: 3 | loss: 0.6495144
	speed: 0.1159s/iter; left time: 1003.1202s
	iters: 400, epoch: 3 | loss: 0.6846300
	speed: 0.1102s/iter; left time: 942.1723s
	iters: 500, epoch: 3 | loss: 0.7063663
	speed: 0.0899s/iter; left time: 759.8691s
	iters: 600, epoch: 3 | loss: 0.7704443
	speed: 0.0594s/iter; left time: 496.1626s
	iters: 700, epoch: 3 | loss: 0.7129053
	speed: 0.0544s/iter; left time: 449.3731s
	iters: 800, epoch: 3 | loss: 0.6274963
	speed: 0.0539s/iter; left time: 439.5747s
	iters: 900, epoch: 3 | loss: 0.7220737
	speed: 0.0543s/iter; left time: 437.4097s
	iters: 1000, epoch: 3 | loss: 0.6945069
	speed: 0.0592s/iter; left time: 470.9401s
	iters: 1100, epoch: 3 | loss: 0.6862649
	speed: 0.0579s/iter; left time: 454.8504s
Epoch: 3 cost time: 84.68963265419006
Epoch: 3, Steps: 1119 | Train Loss: 0.7193954 Vali Loss: 0.5085245 Test Loss: 0.2401517
Validation loss decreased (0.508912 --> 0.508525).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7072531
	speed: 1.4371s/iter; left time: 11114.8830s
	iters: 200, epoch: 4 | loss: 0.7724119
	speed: 0.0459s/iter; left time: 350.4453s
	iters: 300, epoch: 4 | loss: 0.6982108
	speed: 0.0528s/iter; left time: 397.5843s
	iters: 400, epoch: 4 | loss: 0.6943288
	speed: 0.0528s/iter; left time: 392.2282s
	iters: 500, epoch: 4 | loss: 0.7540494
	speed: 0.0634s/iter; left time: 465.0363s
	iters: 600, epoch: 4 | loss: 0.7133144
	speed: 0.0699s/iter; left time: 505.9881s
	iters: 700, epoch: 4 | loss: 0.7086926
	speed: 0.0686s/iter; left time: 489.5972s
	iters: 800, epoch: 4 | loss: 0.6969241
	speed: 0.0657s/iter; left time: 462.2935s
	iters: 900, epoch: 4 | loss: 0.6809121
	speed: 0.0788s/iter; left time: 546.7188s
	iters: 1000, epoch: 4 | loss: 0.7167660
	speed: 0.0631s/iter; left time: 431.4056s
	iters: 1100, epoch: 4 | loss: 0.7839973
	speed: 0.0594s/iter; left time: 400.0265s
Epoch: 4 cost time: 68.54433417320251
Epoch: 4, Steps: 1119 | Train Loss: 0.7158104 Vali Loss: 0.5042130 Test Loss: 0.2393066
Validation loss decreased (0.508525 --> 0.504213).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7059904
	speed: 1.4872s/iter; left time: 9837.5306s
	iters: 200, epoch: 5 | loss: 0.7341626
	speed: 0.0952s/iter; left time: 620.2816s
	iters: 300, epoch: 5 | loss: 0.6637429
	speed: 0.1135s/iter; left time: 727.9142s
	iters: 400, epoch: 5 | loss: 0.6342352
	speed: 0.1213s/iter; left time: 765.9784s
	iters: 500, epoch: 5 | loss: 0.7418816
	speed: 0.0937s/iter; left time: 582.3728s
	iters: 600, epoch: 5 | loss: 0.7260464
	speed: 0.0869s/iter; left time: 531.2077s
	iters: 700, epoch: 5 | loss: 0.7446831
	speed: 0.0564s/iter; left time: 339.3585s
	iters: 800, epoch: 5 | loss: 0.7189059
	speed: 0.0540s/iter; left time: 319.5323s
	iters: 900, epoch: 5 | loss: 0.7370476
	speed: 0.0634s/iter; left time: 368.5625s
	iters: 1000, epoch: 5 | loss: 0.7608981
	speed: 0.0707s/iter; left time: 404.0478s
	iters: 1100, epoch: 5 | loss: 0.7200561
	speed: 0.0586s/iter; left time: 329.2761s
Epoch: 5 cost time: 92.0314416885376
Epoch: 5, Steps: 1119 | Train Loss: 0.7138152 Vali Loss: 0.5029880 Test Loss: 0.2392708
Validation loss decreased (0.504213 --> 0.502988).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6816186
	speed: 1.4762s/iter; left time: 8113.1252s
	iters: 200, epoch: 6 | loss: 0.7270995
	speed: 0.0465s/iter; left time: 251.0162s
	iters: 300, epoch: 6 | loss: 0.7083840
	speed: 0.0620s/iter; left time: 328.3379s
	iters: 400, epoch: 6 | loss: 0.7363931
	speed: 0.0647s/iter; left time: 336.2286s
	iters: 500, epoch: 6 | loss: 0.7318771
	speed: 0.0638s/iter; left time: 325.0461s
	iters: 600, epoch: 6 | loss: 0.7142969
	speed: 0.0609s/iter; left time: 304.1941s
	iters: 700, epoch: 6 | loss: 0.7416227
	speed: 0.0751s/iter; left time: 367.5580s
	iters: 800, epoch: 6 | loss: 0.7291087
	speed: 0.0529s/iter; left time: 253.9269s
	iters: 900, epoch: 6 | loss: 0.6898921
	speed: 0.0571s/iter; left time: 268.0182s
	iters: 1000, epoch: 6 | loss: 0.6928853
	speed: 0.0631s/iter; left time: 289.8509s
	iters: 1100, epoch: 6 | loss: 0.7649043
	speed: 0.0525s/iter; left time: 236.1616s
Epoch: 6 cost time: 66.29042148590088
Epoch: 6, Steps: 1119 | Train Loss: 0.7129068 Vali Loss: 0.5042444 Test Loss: 0.2394681
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 7 | loss: 0.7276566
	speed: 1.4294s/iter; left time: 6256.2782s
	iters: 200, epoch: 7 | loss: 0.6756357
	speed: 0.0501s/iter; left time: 214.1996s
	iters: 300, epoch: 7 | loss: 0.7926280
	speed: 0.0755s/iter; left time: 315.3298s
	iters: 400, epoch: 7 | loss: 0.6575823
	speed: 0.0696s/iter; left time: 283.8324s
	iters: 500, epoch: 7 | loss: 0.6529791
	speed: 0.0816s/iter; left time: 324.3666s
	iters: 600, epoch: 7 | loss: 0.7066456
	speed: 0.0842s/iter; left time: 326.5270s
	iters: 700, epoch: 7 | loss: 0.7058314
	speed: 0.0874s/iter; left time: 330.1774s
	iters: 800, epoch: 7 | loss: 0.6641991
	speed: 0.0835s/iter; left time: 307.0634s
	iters: 900, epoch: 7 | loss: 0.7843524
	speed: 0.0801s/iter; left time: 286.4588s
	iters: 1000, epoch: 7 | loss: 0.6861589
	speed: 0.0609s/iter; left time: 211.9123s
	iters: 1100, epoch: 7 | loss: 0.7531062
	speed: 0.0481s/iter; left time: 162.3271s
Epoch: 7 cost time: 78.77813839912415
Epoch: 7, Steps: 1119 | Train Loss: 0.7123927 Vali Loss: 0.5036916 Test Loss: 0.2392781
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 8 | loss: 0.7388840
	speed: 1.4278s/iter; left time: 4651.8172s
	iters: 200, epoch: 8 | loss: 0.6883022
	speed: 0.0623s/iter; left time: 196.8106s
	iters: 300, epoch: 8 | loss: 0.6418959
	speed: 0.0693s/iter; left time: 211.9113s
	iters: 400, epoch: 8 | loss: 0.7373781
	speed: 0.0622s/iter; left time: 184.0260s
	iters: 500, epoch: 8 | loss: 0.7605484
	speed: 0.0510s/iter; left time: 145.6385s
	iters: 600, epoch: 8 | loss: 0.7163374
	speed: 0.0528s/iter; left time: 145.6461s
	iters: 700, epoch: 8 | loss: 0.7068095
	speed: 0.0528s/iter; left time: 140.4012s
	iters: 800, epoch: 8 | loss: 0.7274511
	speed: 0.0614s/iter; left time: 157.1017s
	iters: 900, epoch: 8 | loss: 0.7447355
	speed: 0.0720s/iter; left time: 177.0406s
	iters: 1000, epoch: 8 | loss: 0.6458176
	speed: 0.0878s/iter; left time: 206.9721s
	iters: 1100, epoch: 8 | loss: 0.7499259
	speed: 0.0816s/iter; left time: 184.3401s
Epoch: 8 cost time: 74.09330296516418
Epoch: 8, Steps: 1119 | Train Loss: 0.7121448 Vali Loss: 0.5036001 Test Loss: 0.2393439
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_336_TimeBridge_custom_bs32_ftM_sl720_ll48_pl336_dm128_nh8_ial1_pdl1_cal1_df128_ebtimeF_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 1, 336, 21) (10204, 1, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.23927105963230133, mae:0.2677096724510193
rmse:0.4891534149646759, mape:0.5592495799064636, mspe:17486670.0
