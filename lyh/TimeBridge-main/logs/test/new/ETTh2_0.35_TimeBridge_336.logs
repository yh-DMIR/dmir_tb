Args in experiment:
Namespace(activation='gelu', alpha=0.35, attn_dropout=0.15, batch_size=16, ca_layers=0, checkpoints='./checkpoints/', d_ff=128, d_model=128, data='ETTh2', data_path='ETTh2.csv', des='Exp', devices='0,1,2,3', dropout=0.0, embed='timeF', embedding_epochs=5, embedding_lr=0.0005, enc_in=7, features='M', freq='h', gpu=0, ia_layers=3, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', model='TimeBridge', model_id='ETTh2_720_336', n_heads=4, num_p=None, num_workers=10, output_attention=False, patience=15, pct_start=0.2, pd_layers=1, period=48, pred_len=336, revin=True, root_path='./dataset/ETT-small/', seasonal_patterns='Monthly', seq_len=720, stable_len=6, target='OT', train_epochs=100, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh2_720_336_TimeBridge_ETTh2_bs16_ftM_sl720_ll48_pl336_dm128_nh4_ial3_pdl1_cal0_df128_ebtimeF_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 2.2463217
	speed: 0.0866s/iter; left time: 4096.2442s
	iters: 200, epoch: 1 | loss: 1.9620265
	speed: 0.0433s/iter; left time: 2044.3697s
	iters: 300, epoch: 1 | loss: 2.2556560
	speed: 0.0452s/iter; left time: 2129.7778s
	iters: 400, epoch: 1 | loss: 1.7662674
	speed: 0.0551s/iter; left time: 2589.5685s
Epoch: 1 cost time: 26.99370503425598
Epoch: 1, Steps: 474 | Train Loss: 2.2515204 Vali Loss: 0.4029862 Test Loss: 0.3722596
Validation loss decreased (inf --> 0.402986).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1264365
	speed: 0.6381s/iter; left time: 29878.8359s
	iters: 200, epoch: 2 | loss: 1.8669808
	speed: 0.0899s/iter; left time: 4201.5554s
	iters: 300, epoch: 2 | loss: 2.2703681
	speed: 0.0893s/iter; left time: 4161.6524s
	iters: 400, epoch: 2 | loss: 1.9579729
	speed: 0.0898s/iter; left time: 4175.8723s
Epoch: 2 cost time: 42.29177165031433
Epoch: 2, Steps: 474 | Train Loss: 2.0883464 Vali Loss: 0.3734210 Test Loss: 0.3752245
Validation loss decreased (0.402986 --> 0.373421).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1350358
	speed: 0.6534s/iter; left time: 30287.4804s
	iters: 200, epoch: 3 | loss: 2.4714103
	speed: 0.0425s/iter; left time: 1965.5022s
	iters: 300, epoch: 3 | loss: 1.9258196
	speed: 0.0478s/iter; left time: 2206.1817s
	iters: 400, epoch: 3 | loss: 2.1342187
	speed: 0.0448s/iter; left time: 2062.1601s
Epoch: 3 cost time: 22.207443475723267
Epoch: 3, Steps: 474 | Train Loss: 2.0373696 Vali Loss: 0.3775835 Test Loss: 0.3730208
EarlyStopping counter: 1 out of 15
	iters: 100, epoch: 4 | loss: 2.2461202
	speed: 0.6088s/iter; left time: 27929.3143s
	iters: 200, epoch: 4 | loss: 1.9905989
	speed: 0.0716s/iter; left time: 3278.4346s
	iters: 300, epoch: 4 | loss: 1.7614585
	speed: 0.0525s/iter; left time: 2397.5809s
	iters: 400, epoch: 4 | loss: 2.2016077
	speed: 0.0503s/iter; left time: 2291.5462s
Epoch: 4 cost time: 30.469528675079346
Epoch: 4, Steps: 474 | Train Loss: 2.0163883 Vali Loss: 0.3740454 Test Loss: 0.3727159
EarlyStopping counter: 2 out of 15
	iters: 100, epoch: 5 | loss: 1.5596911
	speed: 0.6429s/iter; left time: 29190.4593s
	iters: 200, epoch: 5 | loss: 2.0322821
	speed: 0.0920s/iter; left time: 4169.5911s
	iters: 300, epoch: 5 | loss: 1.8351538
	speed: 0.0940s/iter; left time: 4250.1874s
	iters: 400, epoch: 5 | loss: 2.1281614
	speed: 0.0750s/iter; left time: 3381.4874s
Epoch: 5 cost time: 42.59474301338196
Epoch: 5, Steps: 474 | Train Loss: 2.0072306 Vali Loss: 0.3750421 Test Loss: 0.3733841
EarlyStopping counter: 3 out of 15
	iters: 100, epoch: 6 | loss: 2.3760500
	speed: 0.5999s/iter; left time: 26954.1384s
	iters: 200, epoch: 6 | loss: 2.1866832
	speed: 0.0461s/iter; left time: 2067.0568s
	iters: 300, epoch: 6 | loss: 2.7066779
	speed: 0.0516s/iter; left time: 2306.2216s
	iters: 400, epoch: 6 | loss: 2.2388568
	speed: 0.0512s/iter; left time: 2283.1247s
Epoch: 6 cost time: 24.89379858970642
Epoch: 6, Steps: 474 | Train Loss: 2.0023682 Vali Loss: 0.3735412 Test Loss: 0.3743479
EarlyStopping counter: 4 out of 15
	iters: 100, epoch: 7 | loss: 2.4028513
	speed: 0.5113s/iter; left time: 22732.0344s
	iters: 200, epoch: 7 | loss: 1.8643887
	speed: 0.0746s/iter; left time: 3307.9841s
	iters: 300, epoch: 7 | loss: 1.8199868
	speed: 0.0582s/iter; left time: 2574.4276s
	iters: 400, epoch: 7 | loss: 1.8234383
	speed: 0.0503s/iter; left time: 2221.7566s
Epoch: 7 cost time: 31.238297700881958
Epoch: 7, Steps: 474 | Train Loss: 1.9996610 Vali Loss: 0.3721599 Test Loss: 0.3743509
Validation loss decreased (0.373421 --> 0.372160).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7120470
	speed: 0.7900s/iter; left time: 34746.6366s
	iters: 200, epoch: 8 | loss: 1.6206152
	speed: 0.0981s/iter; left time: 4305.7283s
	iters: 300, epoch: 8 | loss: 1.7481948
	speed: 0.1009s/iter; left time: 4419.0582s
	iters: 400, epoch: 8 | loss: 1.9620156
	speed: 0.0896s/iter; left time: 3914.3060s
Epoch: 8 cost time: 43.44794416427612
Epoch: 8, Steps: 474 | Train Loss: 1.9985592 Vali Loss: 0.3725579 Test Loss: 0.3738289
EarlyStopping counter: 1 out of 15
	iters: 100, epoch: 9 | loss: 1.9869399
	speed: 0.4810s/iter; left time: 20926.9630s
	iters: 200, epoch: 9 | loss: 1.7958028
	speed: 0.0563s/iter; left time: 2445.5981s
	iters: 300, epoch: 9 | loss: 2.1124880
	speed: 0.0497s/iter; left time: 2152.9899s
	iters: 400, epoch: 9 | loss: 2.1949830
	speed: 0.0520s/iter; left time: 2248.8851s
Epoch: 9 cost time: 25.62021827697754
Epoch: 9, Steps: 474 | Train Loss: 1.9979031 Vali Loss: 0.3719378 Test Loss: 0.3739711
Validation loss decreased (0.372160 --> 0.371938).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9317524
	speed: 0.5180s/iter; left time: 22290.7087s
	iters: 200, epoch: 10 | loss: 1.8950565
	speed: 0.0568s/iter; left time: 2437.6965s
	iters: 300, epoch: 10 | loss: 1.9916508
	speed: 0.0457s/iter; left time: 1958.3456s
	iters: 400, epoch: 10 | loss: 2.0936480
	speed: 0.0455s/iter; left time: 1942.7987s
Epoch: 10 cost time: 25.231906175613403
Epoch: 10, Steps: 474 | Train Loss: 1.9974541 Vali Loss: 0.3712972 Test Loss: 0.3741732
Validation loss decreased (0.371938 --> 0.371297).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0016026
	speed: 0.7517s/iter; left time: 31994.8521s
	iters: 200, epoch: 11 | loss: 1.7213703
	speed: 0.1101s/iter; left time: 4673.9853s
	iters: 300, epoch: 11 | loss: 1.8891952
	speed: 0.1133s/iter; left time: 4798.5210s
	iters: 400, epoch: 11 | loss: 1.7508421
	speed: 0.1017s/iter; left time: 4299.8679s
Epoch: 11 cost time: 49.4800968170166
Epoch: 11, Steps: 474 | Train Loss: 1.9971698 Vali Loss: 0.3717895 Test Loss: 0.3741581
EarlyStopping counter: 1 out of 15
	iters: 100, epoch: 12 | loss: 2.0977376
	speed: 0.6110s/iter; left time: 25713.8671s
	iters: 200, epoch: 12 | loss: 1.9653975
	speed: 0.0477s/iter; left time: 2000.8653s
	iters: 300, epoch: 12 | loss: 2.1017497
	speed: 0.0445s/iter; left time: 1864.3992s
	iters: 400, epoch: 12 | loss: 2.4267330
	speed: 0.0446s/iter; left time: 1863.2362s
Epoch: 12 cost time: 23.526864528656006
Epoch: 12, Steps: 474 | Train Loss: 1.9970284 Vali Loss: 0.3717521 Test Loss: 0.3741792
EarlyStopping counter: 2 out of 15
	iters: 100, epoch: 13 | loss: 2.1291766
	speed: 0.4440s/iter; left time: 18477.8737s
	iters: 200, epoch: 13 | loss: 2.2135627
	speed: 0.0551s/iter; left time: 2286.1339s
	iters: 300, epoch: 13 | loss: 1.7458285
	speed: 0.0535s/iter; left time: 2217.3496s
	iters: 400, epoch: 13 | loss: 2.1654036
	speed: 0.0506s/iter; left time: 2091.8757s
Epoch: 13 cost time: 26.024859189987183
Epoch: 13, Steps: 474 | Train Loss: 1.9970277 Vali Loss: 0.3718517 Test Loss: 0.3741765
EarlyStopping counter: 3 out of 15
	iters: 100, epoch: 14 | loss: 1.9261110
	speed: 0.6934s/iter; left time: 28524.4999s
	iters: 200, epoch: 14 | loss: 2.3371978
	speed: 0.0557s/iter; left time: 2285.4586s
	iters: 300, epoch: 14 | loss: 2.0533113
	speed: 0.0576s/iter; left time: 2359.6255s
	iters: 400, epoch: 14 | loss: 1.7918699
	speed: 0.0576s/iter; left time: 2351.9621s
Epoch: 14 cost time: 28.177574396133423
Epoch: 14, Steps: 474 | Train Loss: 1.9970739 Vali Loss: 0.3718404 Test Loss: 0.3741750
EarlyStopping counter: 4 out of 15
	iters: 100, epoch: 15 | loss: 1.9145319
	speed: 0.5046s/iter; left time: 20519.7767s
	iters: 200, epoch: 15 | loss: 1.8628252
	speed: 0.0481s/iter; left time: 1951.7422s
	iters: 300, epoch: 15 | loss: 1.8086274
	speed: 0.0481s/iter; left time: 1946.9861s
	iters: 400, epoch: 15 | loss: 2.0174365
	speed: 0.0526s/iter; left time: 2125.0059s
Epoch: 15 cost time: 24.39011240005493
Epoch: 15, Steps: 474 | Train Loss: 1.9968543 Vali Loss: 0.3718477 Test Loss: 0.3741775
EarlyStopping counter: 5 out of 15
	iters: 100, epoch: 16 | loss: 1.8723483
	speed: 0.4198s/iter; left time: 16873.4465s
	iters: 200, epoch: 16 | loss: 1.7584932
	speed: 0.0556s/iter; left time: 2229.5625s
	iters: 300, epoch: 16 | loss: 2.1025848
	speed: 0.0501s/iter; left time: 2005.0926s
	iters: 400, epoch: 16 | loss: 2.1625795
	speed: 0.0575s/iter; left time: 2293.7176s
Epoch: 16 cost time: 27.02380609512329
Epoch: 16, Steps: 474 | Train Loss: 1.9969576 Vali Loss: 0.3717246 Test Loss: 0.3741780
EarlyStopping counter: 6 out of 15
	iters: 100, epoch: 17 | loss: 1.7075237
	speed: 0.6231s/iter; left time: 24748.5051s
	iters: 200, epoch: 17 | loss: 2.0483181
	speed: 0.0579s/iter; left time: 2294.7344s
	iters: 300, epoch: 17 | loss: 1.8153436
	speed: 0.0516s/iter; left time: 2038.1419s
	iters: 400, epoch: 17 | loss: 2.0803094
	speed: 0.0558s/iter; left time: 2197.7434s
Epoch: 17 cost time: 27.419182062149048
Epoch: 17, Steps: 474 | Train Loss: 1.9971271 Vali Loss: 0.3718154 Test Loss: 0.3741779
EarlyStopping counter: 7 out of 15
	iters: 100, epoch: 18 | loss: 2.7542477
	speed: 0.3989s/iter; left time: 15652.3162s
	iters: 200, epoch: 18 | loss: 1.7932688
	speed: 0.0351s/iter; left time: 1372.0651s
	iters: 300, epoch: 18 | loss: 2.1875663
	speed: 0.0380s/iter; left time: 1485.0349s
	iters: 400, epoch: 18 | loss: 2.1599712
	speed: 0.0430s/iter; left time: 1673.5031s
Epoch: 18 cost time: 19.43960165977478
Epoch: 18, Steps: 474 | Train Loss: 1.9968748 Vali Loss: 0.3717950 Test Loss: 0.3741780
EarlyStopping counter: 8 out of 15
	iters: 100, epoch: 19 | loss: 1.6943994
	speed: 0.5261s/iter; left time: 20396.0500s
	iters: 200, epoch: 19 | loss: 1.9235610
	speed: 0.0655s/iter; left time: 2532.2916s
	iters: 300, epoch: 19 | loss: 1.8088200
	speed: 0.0568s/iter; left time: 2191.1186s
	iters: 400, epoch: 19 | loss: 2.0958943
	speed: 0.0630s/iter; left time: 2424.6513s
Epoch: 19 cost time: 30.684402465820312
Epoch: 19, Steps: 474 | Train Loss: 1.9970705 Vali Loss: 0.3717335 Test Loss: 0.3741780
EarlyStopping counter: 9 out of 15
	iters: 100, epoch: 20 | loss: 1.7563679
	speed: 0.4633s/iter; left time: 17742.6934s
	iters: 200, epoch: 20 | loss: 2.0495467
	speed: 0.0420s/iter; left time: 1604.2657s
	iters: 300, epoch: 20 | loss: 1.8854288
	speed: 0.0392s/iter; left time: 1492.9252s
	iters: 400, epoch: 20 | loss: 2.0998435
	speed: 0.0374s/iter; left time: 1421.2697s
Epoch: 20 cost time: 18.88411521911621
Epoch: 20, Steps: 474 | Train Loss: 1.9969973 Vali Loss: 0.3718355 Test Loss: 0.3741780
EarlyStopping counter: 10 out of 15
	iters: 100, epoch: 21 | loss: 1.8200214
	speed: 0.3324s/iter; left time: 12571.7307s
	iters: 200, epoch: 21 | loss: 2.0158181
	speed: 0.0407s/iter; left time: 1533.5211s
	iters: 300, epoch: 21 | loss: 2.1842198
	speed: 0.0515s/iter; left time: 1937.3085s
	iters: 400, epoch: 21 | loss: 1.7015897
	speed: 0.0560s/iter; left time: 2100.1753s
Epoch: 21 cost time: 24.220601558685303
Epoch: 21, Steps: 474 | Train Loss: 1.9970016 Vali Loss: 0.3718366 Test Loss: 0.3741780
EarlyStopping counter: 11 out of 15
	iters: 100, epoch: 22 | loss: 1.7058983
	speed: 0.5978s/iter; left time: 22325.7276s
	iters: 200, epoch: 22 | loss: 1.9386605
	speed: 0.0593s/iter; left time: 2207.1820s
	iters: 300, epoch: 22 | loss: 1.9422445
	speed: 0.0639s/iter; left time: 2372.8258s
	iters: 400, epoch: 22 | loss: 2.3604126
	speed: 0.0634s/iter; left time: 2349.9610s
Epoch: 22 cost time: 30.308818340301514
Epoch: 22, Steps: 474 | Train Loss: 1.9969200 Vali Loss: 0.3718226 Test Loss: 0.3741780
EarlyStopping counter: 12 out of 15
	iters: 100, epoch: 23 | loss: 2.1355217
	speed: 0.4965s/iter; left time: 18307.7720s
	iters: 200, epoch: 23 | loss: 1.7869488
	speed: 0.0512s/iter; left time: 1881.8002s
	iters: 300, epoch: 23 | loss: 2.0492437
	speed: 0.0511s/iter; left time: 1873.0699s
	iters: 400, epoch: 23 | loss: 2.1925008
	speed: 0.0521s/iter; left time: 1905.8617s
Epoch: 23 cost time: 24.971163272857666
Epoch: 23, Steps: 474 | Train Loss: 1.9969003 Vali Loss: 0.3714491 Test Loss: 0.3741780
EarlyStopping counter: 13 out of 15
	iters: 100, epoch: 24 | loss: 1.6140956
	speed: 0.5233s/iter; left time: 19047.5432s
	iters: 200, epoch: 24 | loss: 1.7013800
	speed: 0.0492s/iter; left time: 1784.3696s
	iters: 300, epoch: 24 | loss: 1.7384734
	speed: 0.0562s/iter; left time: 2034.8066s
	iters: 400, epoch: 24 | loss: 2.1595175
	speed: 0.0500s/iter; left time: 1803.3904s
Epoch: 24 cost time: 24.921305894851685
Epoch: 24, Steps: 474 | Train Loss: 1.9970445 Vali Loss: 0.3718501 Test Loss: 0.3741780
EarlyStopping counter: 14 out of 15
	iters: 100, epoch: 25 | loss: 2.5463307
	speed: 0.4533s/iter; left time: 16285.8624s
	iters: 200, epoch: 25 | loss: 1.7304788
	speed: 0.0568s/iter; left time: 2035.4273s
	iters: 300, epoch: 25 | loss: 1.6613159
	speed: 0.0558s/iter; left time: 1992.9631s
	iters: 400, epoch: 25 | loss: 2.0249302
	speed: 0.0548s/iter; left time: 1953.3704s
Epoch: 25 cost time: 26.708428144454956
Epoch: 25, Steps: 474 | Train Loss: 1.9970714 Vali Loss: 0.3718502 Test Loss: 0.3741780
EarlyStopping counter: 15 out of 15
Early stopping
>>>>>>>testing : ETTh2_720_336_TimeBridge_ETTh2_bs16_ftM_sl720_ll48_pl336_dm128_nh4_ial3_pdl1_cal0_df128_ebtimeF_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.3741731345653534, mae:0.40459901094436646
rmse:0.6116969585418701, mape:0.5590695142745972, mspe:395.4769287109375
